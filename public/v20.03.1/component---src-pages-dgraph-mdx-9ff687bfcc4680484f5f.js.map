{"version":3,"sources":["webpack:///./src/pages/dgraph.mdx"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","pageContext","frontmatter","title","parentName","isMDXComponent"],"mappings":"2OAMaA,EAAe,GAOtBC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,EACF,8BACD,OAAO,YAACJ,EAAD,iBAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,sBAAKD,EAAME,YAAYC,YAAYC,OACnC,2EACA,ySACA,sNAAqM,+BAAGC,WAAW,KAAQ,CACvN,KAAQ,gEADyL,QAArM,+FAEiH,0BAAYA,WAAW,KAAvB,4BAFjH,KAGA,4DACA,0LAAyK,0BAAYA,WAAW,KAAvB,KAAzK,yMACA,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,qBADZ,oIAWL,uDACA,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,qBADZ,uLAeL,iEAAgD,0BAAYA,WAAW,KAAvB,WAAhD,iBACA,sBACE,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,sCAApB,0DACA,kBAAIA,WAAW,MAAK,0BAAYA,WAAW,MAAvB,oDAApB,kEAEF,mJACA,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,qBADZ,yOAWL,yDACA,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,qBADZ,0KAeL,8EAA6D,0BAAYA,WAAW,KAAvB,QAA7D,0IACA,uBAAK,kCAAMA,WAAW,OAAU,CAC5B,UAAa,qBADZ,4IAYL,qBAAG,kBAAIA,WAAW,KAAf,8HAAkJ,0BAAYA,WAAW,MAAvB,WAAlJ,0HAAiU,0BAAYA,WAAW,MAAvB,WAAjU,kKAAwhB,0BAAYA,WAAW,MAAvB,QAAxhB,QAAklB,0BAAYA,WAAW,MAAvB,QAAllB,mGACH,iCACA,gXACA,+DACA,sBACE,kBAAIA,WAAW,MAAf,0EACA,kBAAIA,WAAW,MAAf,mFACA,kBAAIA,WAAW,MAAf,sBAA2C,0BAAYA,WAAW,MAAvB,WAA3C,SAAyG,0BAAYA,WAAW,MAAvB,aAE3G,8GAA6F,+BAAGA,WAAW,KAAQ,CAC/G,KAAQ,+BADiF,WAA7F,OAE4B,+BAAGA,WAAW,KAAQ,CAC9C,KAAQ,wCADgB,UAF5B,MASJP,EAAWQ,gBAAiB","file":"component---src-pages-dgraph-mdx-9ff687bfcc4680484f5f.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/debabrata/Sites/Projects/Dgraph/graphql-dgraph-web/src/components/layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1>{props.pageContext.frontmatter.title}</h1>\n    <p>{`How to use GraphQL on an existing Dgraph instance.`}</p>\n    <p>{`If you have an existing Dgraph instance and want to also expose GraphQL, you need to add a GraphQL schema that maps to your Dgraph schema.  You don't need to expose your entire Dgraph schema as GraphQL, but do note that adding a GraphQL schema can alter the Dgraph schema.`}</p>\n    <p>{`Dgraph also allows type and edge names that aren't valid in GraphQL, so, often, you'll need to expose valid GraphQL names. Dgraph admits special characters and even different languages (see `}<a parentName=\"p\" {...{\n        \"href\": \"https://docs.dgraph.io/query-language/#predicate-name-rules\"\n      }}>{`here`}</a>{`), while the GraphQL Spec requires that type and field (predicate) names are generated from `}<inlineCode parentName=\"p\">{`/[_A-Za-z][_0-9A-Za-z]*/`}</inlineCode>{`.`}</p>\n    <h1>{`Mapping GraphQL to a Dgraph schema`}</h1>\n    <p>{`By default, Dgraph generates a new predicate for each field in a GraphQL type. The name of the generated predicate is composed of the type name followed by a dot `}<inlineCode parentName=\"p\">{`.`}</inlineCode>{` and ending with the field name. Therefore, two different types with fields of the same name will turn out to be different Dgraph predicates and can have different indexes.  For example, the types:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`type Person {\n    name: String @search(by: [hash])\n    age: Int\n}\n\ntype Movie {\n    name: String @search(by: [term])\n}\n`}</code></pre>\n    <p>{`generate a Dgraph schema like:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`type Person {\n    Person.name\n    Person.age\n}\n\ntype Movie {\n    Movie.name\n}\n\nPerson.name: string @index(hash) .\nPerson.age: int .\nMovie.name: string @index(term) .\n`}</code></pre>\n    <p>{`This behavior can be customized with the `}<inlineCode parentName=\"p\">{`@dgraph`}</inlineCode>{` directive.  `}</p>\n    <ul>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`type T @dgraph(type: \"DgraphType\")`}</inlineCode>{` controls what Dgraph type is used for a GraphQL type.`}</li>\n      <li parentName=\"ul\"><inlineCode parentName=\"li\">{`field: SomeType @dgraph(pred: \"DgraphPredicate\")`}</inlineCode>{` controls what Dgraph predicate is mapped to a GraphQL field.`}</li>\n    </ul>\n    <p>{`For example, if you have existing types that don't match GraphQL requirements, you can create a schema like the following.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`type Person @dgraph(type: \"Human-Person\") {\n    name: String @search(by: [hash]) @dgraph(pred: \"name\")\n    age: Int\n}\n\ntype Movie @dgraph(type: \"film\") {\n    name: String @search(by: [term]) @dgraph(pred: \"film.name\")\n}\n`}</code></pre>\n    <p>{`Which maps to the Dgraph schema:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`type Human-Person {\n    name\n    Person.age\n}\n\ntype film {\n    film.name\n}\n\nname string @index(hash) .\nPerson.age: int .\nfilm.name string @index(term) .\n`}</code></pre>\n    <p>{`You might also have the situation where you have used `}<inlineCode parentName=\"p\">{`name`}</inlineCode>{` for both movie names and people's names.  In this case you can map fields in two different GraphQL types to the one Dgraph predicate.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`type Person {\n    name: String @dgraph(pred: \"name\")\n    ...\n}\n\ntype Movie {\n    name: String @dgraph(pred: \"name\")\n    ...\n}\n`}</code></pre>\n    <p><em parentName=\"p\">{`Note: the current behavior requires that when two fields are mapped to the same Dgraph predicate both should have the same `}<inlineCode parentName=\"em\">{`@search`}</inlineCode>{` directive.  This is likely to change in a future release where the underlying Dgraph indexes will be the union of the `}<inlineCode parentName=\"em\">{`@search`}</inlineCode>{` directives, while the generated GraphQL API will expose only the search given for the particular field.  Allowing, for example, dgraph predicate name to have `}<inlineCode parentName=\"em\">{`term`}</inlineCode>{` and `}<inlineCode parentName=\"em\">{`hash`}</inlineCode>{` indexes, but exposing only term search for GraphQL movies and hash search for GraphQL people.`}</em></p>\n    <h1>{`Roadmap`}</h1>\n    <p>{`Be careful with mapping to an existing Dgraph instance.  Updating the GraphQL schema updates the underlying Dgraph schema. We understand that exposing a GraphQL API on an existing Dgraph instance is a delicate process and we plan on adding multiple checks to ensure the validity of schema changes to avoid issues caused by detectable mistakes.`}</p>\n    <p>{`Future features are likely to include:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Generating a first pass GraphQL schema from an existing dgraph schema.`}</li>\n      <li parentName=\"ul\">{`A way to show what schema diff will happen when you apply a new GraphQL schema.`}</li>\n      <li parentName=\"ul\">{`Better handling of `}<inlineCode parentName=\"li\">{`@dgraph`}</inlineCode>{` with `}<inlineCode parentName=\"li\">{`@search`}</inlineCode></li>\n    </ul>\n    <p>{`We look forward to you letting us know what features you'd like, so please join us on `}<a parentName=\"p\" {...{\n        \"href\": \"https://discuss.dgraph.io/\"\n      }}>{`discuss`}</a>{` or `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/dgraph-io/dgraph\"\n      }}>{`GitHub`}</a>{`.`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}