(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"o52/":function(e,a,t){"use strict";t.r(a),t.d(a,"_frontmatter",(function(){return l})),t.d(a,"default",(function(){return c}));t("rzGZ"),t("Dq+y"),t("8npG"),t("Ggvi"),t("E5k/"),t("q1tI");var n=t("7ljp"),s=t("Bl7J");var l={},i={_frontmatter:l},r=s.a;function c(e){var a=e.components,t=function(e,a){if(null==e)return{};var t,n,s={},l=Object.keys(e);for(n=0;n<l.length;n++)t=l[n],a.indexOf(t)>=0||(s[t]=e[t]);return s}(e,["components"]);return Object(n.b)(r,Object.assign({},i,t,{components:a,mdxType:"MDXLayout"}),Object(n.b)("h1",null,t.pageContext.frontmatter.title),Object(n.b)("p",null,"Let's start with listing down the entities that are involved in a basic todo app."),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Task"),Object(n.b)("li",{parentName:"ul"},"User")),Object(n.b)("p",null,Object(n.b)("span",Object.assign({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"581px"}}),"\n      ",Object(n.b)("span",Object.assign({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"38.036809815950924%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAAmklEQVQoz41SSw5AEQx0/6uxsLAgroGNT19GUmkEeU1EtZ3pj+q9UymFcs7zQIcNMsY43idMa236VEqJaq0zGAc6bBzAdkn6wig8doEDmU/VoZoXRuGBAO89hRBWZbINSSoTIT7GuPyLEAbnHGmtV/Y/hNZaMsasmU/CPy3LGd5aBukk5GEyCPq+lH3DL4ziapCZv8KNTJLeMB+YR3PEwSRHMQAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.b)("img",Object.assign({parentName:"span"},{className:"gatsby-resp-image-image",alt:"Todo Graph",title:"Todo Graph",src:"/static/24166bd24b96146583fae024f32863e1/92d15/todo-graph.png",srcSet:["/static/24166bd24b96146583fae024f32863e1/222b7/todo-graph.png 163w","/static/24166bd24b96146583fae024f32863e1/ff46a/todo-graph.png 325w","/static/24166bd24b96146583fae024f32863e1/92d15/todo-graph.png 581w"],sizes:"(max-width: 581px) 100vw, 581px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    ")),Object(n.b)("p",null,"Equivalent GraphQL schema for the graph above would be as follow:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),"type Task {\n    ...\n}\n\ntype User {\n    ...\n}\n")),Object(n.b)("p",null,"What are the fields that these two simple entities contain?"),Object(n.b)("p",null,"We have a title and a status to check if it was completed or not in the ",Object(n.b)("inlineCode",{parentName:"p"},"Task")," type.\nThen the  ",Object(n.b)("inlineCode",{parentName:"p"},"User")," type has a username (unique identifier), name and the tasks."),Object(n.b)("p",null,"So each user can have many tasks."),Object(n.b)("p",null,Object(n.b)("span",Object.assign({parentName:"p"},{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"581px"}}),"\n      ",Object(n.b)("span",Object.assign({parentName:"span"},{className:"gatsby-resp-image-background-image",style:{paddingBottom:"38.036809815950924%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAAA80lEQVQoz3WSyYqFQAxF/f+/EpcuREVBcCEuRRDn2fQ7gRTyujsQq5LUvZn07vuWZVlkmiYZx1Hv+JDneeQtZr8xKPfrujTm4TjP04EI4HuTETeb8z8Mp8eHjGmaSpZlCkCbppFt2zR7nCTSdd0vsmEYtCurep5n8SxrURQSRZF73Latgo/jkHVdlRw1AiQIAvF939mOELFZWAKCEJGALiCGkEQIsbqupaoqxTpCexzHsYRhqE4IaUer+5CUZSl93ys5Jxje5HkuyWccNmMl5ENlEDAnbNS2hnxvnrbNfi/KLQXAvu9uXkZmC/rrt7HE3wX8AAXubY/06RIRAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}})),"\n  ",Object(n.b)("img",Object.assign({parentName:"span"},{className:"gatsby-resp-image-image",alt:"Todo Graph complete",title:"Todo Graph complete",src:"/static/fd7f7ecfa9e5023dda5ce2cad525e5ca/92d15/todo-graph-2.png",srcSet:["/static/fd7f7ecfa9e5023dda5ce2cad525e5ca/222b7/todo-graph-2.png 163w","/static/fd7f7ecfa9e5023dda5ce2cad525e5ca/ff46a/todo-graph-2.png 325w","/static/fd7f7ecfa9e5023dda5ce2cad525e5ca/92d15/todo-graph-2.png 581w"],sizes:"(max-width: 581px) 100vw, 581px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"})),"\n    "),"\n*Note - ' ","*"," ' signifies one-to-many relationship"),Object(n.b)("p",null,"Now let's add  ",Object(n.b)("inlineCode",{parentName:"p"},"@id")," directive to ",Object(n.b)("inlineCode",{parentName:"p"},"username ")," which makes it the unique key & also add  ",Object(n.b)("inlineCode",{parentName:"p"},"@hasInverse")," directive to enable the above relationship between tasks and user.\nWe represent that in the GraphQL schema shown below:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),"type Task {\n    id: ID!\n    title: String!\n    completed: Boolean!\n    user: User!\n}\n\ntype User {\n    username: String! @id\n    name: String\n    tasks: [Task] @hasInverse(field: user)\n}\n")),Object(n.b)("p",null,"Save the content in a file ",Object(n.b)("inlineCode",{parentName:"p"},"schema.graphql"),"."),Object(n.b)("h3",null,Object(n.b)("a",{name:"Running"}),"Running"),Object(n.b)("p",null,"Before we begin, make sure that you have ",Object(n.b)("a",Object.assign({parentName:"p"},{href:"https://docs.docker.com/install/"}),"Docker"),"\ninstalled on your machine."),Object(n.b)("p",null,"Let's begin by starting Dgraph standalone by running the command below:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"docker run -it -p 8080:8080 dgraph/standalone:master\n")),Object(n.b)("p",null,"Let's load up the GraphQL schema file to Dgraph:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"curl -X POST localhost:8080/admin/schema --data-binary '@schema.graphql'\n")),Object(n.b)("p",null,"You can access that GraphQL endpoint with any of the great GraphQL developer tools.\nGood choices include GraphQL Playground, Insomnia, GraphiQL and Altair."),Object(n.b)("p",null,"Set up any of them and point it at ",Object(n.b)("inlineCode",{parentName:"p"},"http://localhost:8080/graphql"),". If you know lots about GraphQL, you might want to explore the schema, queries and mutations that were generated from the schema."),Object(n.b)("h3",null,Object(n.b)("a",{name:"Mutating"}),"Mutating Data"),Object(n.b)("p",null,"Let's add a user and some todos in our Todo App."),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),'mutation {\n  addUser(input: [\n    {\n      username: "alice@dgraph.io",\n      name: "Alice",\n      tasks: [\n        {\n          title: "Avoid touching your face",\n          completed: false,\n        },\n        {\n          title: "Stay safe",\n          completed: false\n        },\n        {\n          title: "Avoid crowd",\n          completed: true,\n        },\n        {\n          title: "Wash your hands often",\n          completed: true\n        }\n      ]\n    }\n  ]) {\n    user {\n      username\n      name\n      tasks {\n        id\n        title\n      }\n    }\n  }\n}\n')),Object(n.b)("h3",null,Object(n.b)("a",{name:"Querying"}),"Querying Data"),Object(n.b)("p",null,"Let's fetch the todos to list in our Todo App:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),"query {\n  queryTask {\n    id\n    title\n    completed\n    user {\n        username\n    }\n  }\n}\n")),Object(n.b)("p",null,"Running the query above should return JSON response as shown below:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-json"}),'{\n  "data": {\n    "queryTask": [\n      {\n        "id": "0x3",\n        "title": "Avoid touching your face",\n        "completed": false,\n        "user": {\n          "username": "alice@dgraph.io"\n        }\n      },\n      {\n        "id": "0x4",\n        "title": "Stay safe",\n        "completed": false,\n        "user": {\n          "username": "alice@dgraph.io"\n        }\n      },\n      {\n        "id": "0x5",\n        "title": "Avoid crowd",\n        "completed": true,\n        "user": {\n          "username": "alice@dgraph.io"\n        }\n      },\n      {\n        "id": "0x6",\n        "title": "Wash your hands often",\n        "completed": true,\n        "user": {\n          "username": "alice@dgraph.io"\n        }\n      }\n    ]\n  }\n}\n')),Object(n.b)("h3",null,Object(n.b)("a",{name:"Querying with Filters"}),"Querying Data with Filters"),Object(n.b)("p",null,"Before we get into querying data with filters, we will be required\nto define search indexes to the specific fields."),Object(n.b)("p",null,"Let's say we have to run a query on the ",Object(n.b)("em",{parentName:"p"},"completed")," field, for which\nwe add ",Object(n.b)("inlineCode",{parentName:"p"},"@search")," directive to the field, as shown in the schema below:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),"type Task {\n  id: ID!\n  title: String!\n  completed: Boolean! @search\n}\n")),Object(n.b)("p",null,"The ",Object(n.b)("inlineCode",{parentName:"p"},"@search")," directive is added to support the native search indexes of ",Object(n.b)("strong",{parentName:"p"},"Dgraph"),"."),Object(n.b)("p",null,"Resubmit the updated schema -"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"curl -X POST localhost:8080/admin/schema --data-binary '@schema.graphql'\n")),Object(n.b)("p",null,"Now, let's fetch all todos which are completed :"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),'query {\n  queryTask(filter: {\n    completed: {\n      eq: "true"\n    }\n  }) {\n    id\n    title\n  }\n}\n')),Object(n.b)("p",null,"Next, let's say we have to run a query on the ",Object(n.b)("em",{parentName:"p"},"title")," field, for which\nwe add another ",Object(n.b)("inlineCode",{parentName:"p"},"@search")," directive to the field, as shown in the schema below:"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),"type Task {\n    id: ID!\n    title: String! @search(by: [fulltext])\n    completed: Boolean! @search\n}\n")),Object(n.b)("p",null,"The ",Object(n.b)("inlineCode",{parentName:"p"},"fulltext")," search index provides the advanced search capability to perform equality\ncomparison as well as matching with language-specific stemming and stopwords."),Object(n.b)("p",null,"Resubmit the updated schema -"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-bash"}),"curl -X POST localhost:8080/admin/schema --data-binary '@schema.graphql'\n")),Object(n.b)("p",null,"Now, let's try to fetch todos whose title has the word ",Object(n.b)("em",{parentName:"p"},'"remember"')," :"),Object(n.b)("pre",null,Object(n.b)("code",Object.assign({parentName:"pre"},{className:"language-graphql"}),'query {\n  queryTask(filter: {\n    title: {\n      alloftext: "avoid"\n    }\n  }) {\n    id\n    title\n    completed\n  }\n}\n')))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-tutorials-todo-app-tutorial-todo-schema-design-mdx-17abc26be9d1e54d2134.js.map