{"version":3,"sources":["webpack:///./src/pages/tutorials/todo-app-tutorial/todo-auth0-jwt.mdx"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","pageContext","frontmatter","title","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-tutorials-todo-app-tutorial-todo-auth-0-jwt-mdx-80174f6b0eb5a1c93cd8.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/debabrata/Sites/Projects/Dgraph/graphql-dgraph-web/src/components/layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1>{props.pageContext.frontmatter.title}</h1>\n    <p>{`Let's start by going to our Auth0 dashboard where we can see the application which we have already created and used in our frontend-application.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"650px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"65.03067484662577%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAABgklEQVQ4y21T2W6DMBDk/78vb30olVJVFQHM4YtrsmPY1oGsNFr5mp09XKBvYb4+0dkAWowR3jmEEODEc02bpgnjOMJ7n87atkVVPdD3vew5/FQdTO9RbOuK6ANC9nAYbXo8zzNWOafRL8uS/LZtf+t/7HeLWRaDtXASmfZRfqO83fBbVSjLEvf7/YWAARUaLLdiEWWhqSktbSR1pkuXmRpBIqpl0GEY052+H+Rsz4oBFcUsRE7Sm4SYG9Mq2LDXUc7issFNM8K84J3lZDuhRG+kwCwujY3oug5WyrCmVLfkF1G8nnAmS4SshTFGUhkSoaaXe945P9QgV4XyiIp0PPJUuEcyqk4BDmiwKEh3X5oih0w3V6FjwpmzQlY3DR51DXOUYhQMUnfrw7UpVMEhnY4u54SO4ySELImiFTAQ4d51mYRUSJ/PVfoxmUI2LoeRN/aY3UtTakmHP0PV6Y/R79cIIbOgZ725x5/Fel4HWzZZl3jMoY4DybS29kid0Cz07hlPsj76QsDV5BMAAAAASUVORK5CYII=')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"Dashboard\",\n          \"title\": \"Dashboard\",\n          \"src\": \"/static/b41c7fb9309ec2b00192ea7fe06a2fc4/a6d36/dashboard.png\",\n          \"srcSet\": [\"/static/b41c7fb9309ec2b00192ea7fe06a2fc4/222b7/dashboard.png 163w\", \"/static/b41c7fb9309ec2b00192ea7fe06a2fc4/ff46a/dashboard.png 325w\", \"/static/b41c7fb9309ec2b00192ea7fe06a2fc4/a6d36/dashboard.png 650w\", \"/static/b41c7fb9309ec2b00192ea7fe06a2fc4/e548f/dashboard.png 975w\", \"/static/b41c7fb9309ec2b00192ea7fe06a2fc4/f680b/dashboard.png 1108w\"],\n          \"sizes\": \"(max-width: 650px) 100vw, 650px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <p>{`Now we want to use the JWT that Auth0 generates, but we also need to add custom claims to that token which will be used by our auth rules.\nSo we can use something known as \"Rules\" (left sidebar on dashboard page) to add custom claims to a token. Let's create a new empty rule.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"650px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"69.32515337423312%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsSAAALEgHS3X78AAACY0lEQVQ4y51TS08TURSevZG9PCSNifZhEVDE0uKDuHdDfAZjDQkRmy5EJahEIgtNNPHXaCJqXPpKJEDiUqEk9DEd2s6087gz089zbkut4sLwJV/OPefe++Xcc85VfC0PLZNBzRZgOI4Dy7Ika7UahBCo1+syXq1WYdu23NM0DaqqQtd1mJaJnFqBUXOg+J4Hy7ToQkOQRfiQcF14ng/f96Ugr10Z81pr0fRdohCN8wpnUCURzoAv5rNZbG6so1goYC9QOH3DMKQYo2y7yJsuCpYLzfFRbKNq/7mWfjO2LeoQfr0hWC6XZYaMH4bAp0wRXzYK+Lyex8efOaxsbWOVuLKlSbuWbfi/Yxq+qwaqLglyLThDFmZsGjYyagmZbAGZXBG5bR2FsoF8SW+Q/VKbL2MVZClmeSRomibUYlGKMnTqpMFNogLv0G5b/8vfiXnUQMUTDhxqCjsSzVruFYqg2umlkpw3xtMXLzGVSuPB/DxmHy9iZn4BdxcWJVOzD5Gae4TbM7OYvnMf02yJqXtzSN5KY3l1DQoPqkHP5HliXLh0DR1dARw6HkeA2DMQIw6jO9KPrnA/2QF0HulD5+Eo2QZ7KL7vQC9evXkLhQe5Uqm0unwlOYmeYBTR+BjCI2OIJM4jPDyK0FAC4ZNEsqGhOIInRlqM0D4LL73/AIWFWHCny5dvTKI31IeB+GmEWTR2FqFTZ0j8HAmOtgnFWowMJ2TGUpDHRn41+jryyRevoqMzgIORQXQH+3YzdGwXe48OYj+V6fXSOyh/d+nJs+cYn0giOZ3G9anUf5HPjk/cxNdvy/gFgqR/88ySSrcAAAAASUVORK5CYII=')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"Rule\",\n          \"title\": \"Rule\",\n          \"src\": \"/static/1dc88ccc5e2648c44cd0d018e4d44b5d/a6d36/rule.png\",\n          \"srcSet\": [\"/static/1dc88ccc5e2648c44cd0d018e4d44b5d/222b7/rule.png 163w\", \"/static/1dc88ccc5e2648c44cd0d018e4d44b5d/ff46a/rule.png 325w\", \"/static/1dc88ccc5e2648c44cd0d018e4d44b5d/a6d36/rule.png 650w\", \"/static/1dc88ccc5e2648c44cd0d018e4d44b5d/e548f/rule.png 975w\", \"/static/1dc88ccc5e2648c44cd0d018e4d44b5d/18c13/rule.png 1005w\"],\n          \"sizes\": \"(max-width: 650px) 100vw, 650px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <p>{`Replace the content with the the following -`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`function (user, context, callback) {\n  const namespace = \"https://dgraph.io/jwt/claims\";\n  context.idToken[namespace] =\n    {\n      'USER': user.email,\n    };\n  \n  return callback(null, user, context);\n}\n`}</code></pre>\n    <p>{`In the above function, we are only just adding the custom claim to the token with a field as `}<inlineCode parentName=\"p\">{`USER`}</inlineCode>{` which if you recall from the last step is used in our auth rules, so it needs to match exactly with that name. `}</p>\n    <p>{`Now let's go to `}<inlineCode parentName=\"p\">{`Settings`}</inlineCode>{` of our Auth0 application and then go down to view the `}<inlineCode parentName=\"p\">{`Advanced Settings`}</inlineCode>{` to check the JWT signature algorithm (OAuth tab) and then get the certificate (Certificates tab). We will be using `}<inlineCode parentName=\"p\">{`RS256`}</inlineCode>{` in this example so let's make sure it's set to that and then copy the certificate which we will use to get the public key.  Use the download certificate button there to get the certificate in `}<inlineCode parentName=\"p\">{`PEM`}</inlineCode>{`. `}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"650px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"66.25766871165644%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAAB7UlEQVQ4y21T2W7cMAz0//ep6UcVBdoCLfrS3Q2SbvaqD/mSbMnXlENbiyCpgYFkihxxSCqZ/p6Rv5zQhRH8vPfo+17hnEMIAdM8w8tqrVU7bWVZIs9zXUPwKEyN3Dgk8zSpwziuhMMwaJAXcD+JnWfcD0PQdRwHXWNcPKNvEuSnkZuZAT/nOlxuKa5pBiv7RtAKbEf0615Q204V1HV99xsGIRzE2EvqmKdVshDXW0BrHcrW3klatTsljufGGLE7/WemySA182Kg9GVZNikeldYoQ9u2WqvT+YyzIM1SJSmKAqaq0Uv8a/kJm5Bma2CsIW0RnUh9enrGbr/H790OL6cTrrcbLterNMLcm0TfO2FVVXoQCemwFnpt0J/jEYfHR+wPhzshYUTFO0IaKIHB/MI2HhHMkAqYEUm4ZwkyjgwlvyUkEbs1y6zFOdT6bHVqpBSldLIwpUrMaRfw3Iiy7i0hyRgYtrHhjZGQsELo6hKNyRVtmcMUuWZqyv8QkoCymCG7zENewnkMncOt7vDpZ42PPyo8CD58r/ArtZiDvCQZn9cN1LHRLqep1ouEk4zPuL0OjlJhe3y+OHxLA76mHl9uHpkLWCZ5IZtffC2MTZqm0ZGJT4+kBEguy7GU5rQNMElJRq+Y5emtLss7/AMey+oZHQBQzwAAAABJRU5ErkJggg==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"Certificate\",\n          \"title\": \"Certificate\",\n          \"src\": \"/static/2e318701e47bb104d78bb1d2328e9a69/a6d36/certificate.png\",\n          \"srcSet\": [\"/static/2e318701e47bb104d78bb1d2328e9a69/222b7/certificate.png 163w\", \"/static/2e318701e47bb104d78bb1d2328e9a69/ff46a/certificate.png 325w\", \"/static/2e318701e47bb104d78bb1d2328e9a69/a6d36/certificate.png 650w\", \"/static/2e318701e47bb104d78bb1d2328e9a69/e548f/certificate.png 975w\", \"/static/2e318701e47bb104d78bb1d2328e9a69/6d74e/certificate.png 1085w\"],\n          \"sizes\": \"(max-width: 650px) 100vw, 650px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <p>{`Now let's run a command to get the public key from it, which we will add to our schema. Just change the `}<inlineCode parentName=\"p\">{`file_name`}</inlineCode>{` and run the command.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`openssl x509 -pubkey -noout -in file_name.pem\n`}</code></pre>\n    <p>{`Copy the public key and now let's add it to our schema. For doing that we will add something like this, to the bottom of our schema file - `}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`# Dgraph.Authorization X-Auth0-Token https://dgraph.io/jwt/claims RS256 \"<AUTH0-APP-PUBLIC-KEY>\"\n`}</code></pre>\n    <p>{`Let me just quickly explain what each thing means in that, so firstly we start the line with a `}<inlineCode parentName=\"p\">{`#  Dgraph.Authorization`}</inlineCode>{`, next is the name of the header `}<inlineCode parentName=\"p\">{`X-Auth0-Token`}</inlineCode>{` (can be anything) which will be used to send the value of the JWT. Next is the custom-claim name `}<inlineCode parentName=\"p\">{`https://dgraph.io/jwt/claims`}</inlineCode>{` (again can be anything, just needs to match with the name specified in Auth0). Then next is the `}<inlineCode parentName=\"p\">{`RS256`}</inlineCode>{` the JWT signature algorithm (another option is `}<inlineCode parentName=\"p\">{`HS256`}</inlineCode>{` but remember to use the same algorithm in Auth0) and lastly, update `}<inlineCode parentName=\"p\">{`<AUTH0-APP-PUBLIC-KEY>`}</inlineCode>{` with your public key within the quotes and make sure to have it in a single line and add `}<inlineCode parentName=\"p\">{`\\\\n`}</inlineCode>{` where ever needed.  The updated schema will look something like this (update the public key with your key) - `}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`type Task @auth(\n    query: { rule: \"\"\"\n        query($USER: String!) {\n            queryTask {\n                user(filter: { username: { eq: $USER } }) {\n                    __typename\n                }\n            }\n        }\"\"\"}), {\n    id: ID!\n    title: String! @search(by: [fulltext])\n    completed: Boolean! @search\n    user: User!\n}\ntype User {\n  username: String! @id @search(by: [hash])\n  name: String\n  tasks: [Task] @hasInverse(field: user)\n}\n# Dgraph.Authorization X-Auth0-Token https://dgraph.io/jwt/claims RS256 \"<AUTH0-APP-PUBLIC-KEY>\"\n`}</code></pre>\n    <p>{`Resubmit the updated schema -`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`curl -X POST localhost:8080/admin/schema --data-binary '@schema.graphql'\n`}</code></pre>\n    <p>{`Let's get that token and see what all it contains, then update the frontend accordingly. For doing this, let's start our app again.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`npm start\n`}</code></pre>\n    <p>{`Now open a browser window, navigate to `}<a parentName=\"p\" {...{\n        \"href\": \"http://localhost:3000\"\n      }}>{`http://localhost:3000`}</a>{` and open the developer tools, go to the `}<inlineCode parentName=\"p\">{`network`}</inlineCode>{` tab and find a call called `}<inlineCode parentName=\"p\">{`token`}</inlineCode>{` to get your JWT from its response JSON (field `}<inlineCode parentName=\"p\">{`id_token`}</inlineCode>{`).`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"650px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"41.717791411042946%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABVUlEQVQoz5WSy3KDMAxF+ZYaGvAL2xAg4WEgbSbTTdNk0v//k1vZE7puF2fkq5GvZEFyOvY49AOGYYT3HsuywM8zrHMojcG6ruiHHuM44ng8ou/7GANd16Gqqkhd1zEmjXVQuiQ0tNKYJo+RGqx+xkCX2nofdWjYUxyniRqQHqdouqwnTFQbzNq2Q8K4RJqm4ELhJU+RGwVGF9ns8bouYH4CnxcUXEAqBV2W4JzDWAshRBykLA2KoogvSvbtAZqSxtiYEErCNU1EO4usyCG0QkVnU2o4a6CkhOAFJBlKMpeCQ9E55JL74xvL6Q3nywfez5do7rTEnrCCuu4YKlmgock7q1AbjUoLqhFUQ5QC9TMGkuvXDSPtwLkqPme328UVMMZizLLsV28EvcGebDr5vN5oqUvcQZoy5Hn+a7IR9F9JbvcHfTmP7hB+gwMk7SdMGfiP0cYPnbH5RtGVwaAAAAAASUVORK5CYII=')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"Token\",\n          \"title\": \"Token\",\n          \"src\": \"/static/41935d286873ae6f2a3dd8eceef1dc33/a6d36/token.png\",\n          \"srcSet\": [\"/static/41935d286873ae6f2a3dd8eceef1dc33/222b7/token.png 163w\", \"/static/41935d286873ae6f2a3dd8eceef1dc33/ff46a/token.png 325w\", \"/static/41935d286873ae6f2a3dd8eceef1dc33/a6d36/token.png 650w\", \"/static/41935d286873ae6f2a3dd8eceef1dc33/636c2/token.png 911w\"],\n          \"sizes\": \"(max-width: 650px) 100vw, 650px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <p>{`Now go to `}<a parentName=\"p\" {...{\n        \"href\": \"https://jwt.io\"\n      }}>{`jwt.io`}</a>{` and paste your token there.`}</p>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"650px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"51.533742331288344%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAABhElEQVQoz2WSjW7bMAyE/f5vt24tuiRomvinWRLHTurYlkTyRpFu0a0GDkdb0Kcj5aKqa7zsdximEVEYDED+U36apsFqtUJ7PiOEgHmewcy2JiKfKhAIOA/A8Qp56yCHDtxcwFpz1YLbm0FjiIiUkIgMRuoZyMTuiwo69uAfW/CvEvJYQdZvkIc95KmG/FQvWwNyIsgwQW5jjvStC1mSFtyPoNcesUmIJSHWqsrrsCOkP+zAOUJ2J++iGyDXO+Si3qu3736QPkV6F8wvwKSaS9UeCNm3+m2jrR7y6QIOCaLt2ayym+hfzwljK5jWunmtvlE95wO8HrUOtV/LeB8x3AewXRy7f9XHDGOnm1cwiIF+53etX70O9ZJQE9AgoBtAV5jz7MOTL79DkW66qdI2K4XsxH3v9bwVxOMC1NOpV5COKGlXdP1+LdbyJ7BZQJoslAtQlU4LMLHNM130W+eSqEq6NrlbwngRG34G5UR5llYvI4iNAymwJoMlM+hZ107uBiQH/gV/dApfxUGYGgAAAABJRU5ErkJggg==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"jwt\",\n          \"title\": \"jwt\",\n          \"src\": \"/static/1288f9a7fb596f27e60d169942b0f4fc/a6d36/jwt.png\",\n          \"srcSet\": [\"/static/1288f9a7fb596f27e60d169942b0f4fc/222b7/jwt.png 163w\", \"/static/1288f9a7fb596f27e60d169942b0f4fc/ff46a/jwt.png 325w\", \"/static/1288f9a7fb596f27e60d169942b0f4fc/a6d36/jwt.png 650w\", \"/static/1288f9a7fb596f27e60d169942b0f4fc/e548f/jwt.png 975w\", \"/static/1288f9a7fb596f27e60d169942b0f4fc/0f246/jwt.png 1118w\"],\n          \"sizes\": \"(max-width: 650px) 100vw, 650px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <p>{`The token also includes our custom claim like below.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`{\n\"https://dgraph.io/jwt/claims\": {\n    \"USER\": \"vardhanapoorv\"\n  },\n  ...\n}\n`}</code></pre>\n    <p>{`Now, you can check if the auth rule that we added is working as expected or not. Open the GraphQL tool (Insomnia, GraphQL Playground) add the URL along with the header `}<inlineCode parentName=\"p\">{`X-Auth0-Token`}</inlineCode>{` and its value as the JWT. Let's try the query to see the todos and only the todos the logged-in user created should be visible.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-graphql\"\n      }}>{`query {\n  queryTask {\n    title\n    completed\n    user {\n        username\n    }\n  }\n}\n`}</code></pre>\n    <p>{`The above should give you only your todos and verifies that our auth rule worked!`}</p>\n    <p>{`Now let's update our frontend application to include the `}<inlineCode parentName=\"p\">{`X-Auth0-Token`}</inlineCode>{` header with value as JWT from Auth0 when sending a  request.`}</p>\n    <p>{`To do this, we need to update the Apollo client setup to include the header while sending the request, and we need to get the JWT from Auth0. `}</p>\n    <p>{`The value we want is in the field `}<inlineCode parentName=\"p\">{`idToken`}</inlineCode>{` from Auth0. We get that by quickly updating `}<inlineCode parentName=\"p\">{`react-auth0-spa.js`}</inlineCode>{` to get `}<inlineCode parentName=\"p\">{`idToken`}</inlineCode>{` and pass it as a prop to our `}<inlineCode parentName=\"p\">{`App`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`...\n\nconst [popupOpen, setPopupOpen] = useState(false);\nconst [idToken, setIdToken] = useState(\"\");\n\n...\n\nif (isAuthenticated) {\n        const user = await auth0FromHook.getUser();\n        setUser(user);\n        const idTokenClaims = await auth0FromHook.getIdTokenClaims();\n        setIdToken(idTokenClaims.__raw);\n}\n\n...\n\nconst user = await auth0Client.getUser();\nconst idTokenClaims = await auth0Client.getIdTokenClaims();\n\nsetIdToken(idTokenClaims.__raw);\n\n...\n\n{children}\n      <App idToken={idToken} />\n    </Auth0Context.Provider>\n\n...\n\n`}</code></pre>\n    <p>{`Check the updated file `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/dgraph-io/graphql-sample-apps/blob/c94b6eb1cec051238b81482a049100b1cd15bbf7/todo-app-react/src/react-auth0-spa.js\"\n      }}>{`here`}</a></p>\n    <p>{` Now let's use that token while creating an Apollo client instance and give it to a header `}<inlineCode parentName=\"p\">{`X-Auth0-Token`}</inlineCode>{` in our case.  Let's update our `}<inlineCode parentName=\"p\">{`src/App.js`}</inlineCode>{` file.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`...\n\nimport { useAuth0 } from \"./react-auth0-spa\";\nimport { setContext } from \"apollo-link-context\";\n\n// Updated to take token\nconst createApolloClient = token => {\n  const httpLink = createHttpLink({\n    uri: config.graphqlUrl,\n    options: {\n      reconnect: true,\n    },\n});\n\n// Add header\nconst authLink = setContext((_, { headers }) => {\n    // return the headers to the context so httpLink can read them\n    return {\n      headers: {\n        ...headers,\n        \"X-Auth-Token\": token,\n      },\n    };\n});\n\n// Include header\nreturn new ApolloClient({\n    link: httpLink,\n    link: authLink.concat(httpLink),\n    cache: new InMemoryCache()\n});\n\n// Get token from props and pass to function\nconst App = ({idToken}) => {\n  const { loading } = useAuth0();\n  if (loading) {\n    return <div>Loading...</div>;\n  }\nconst client = createApolloClient(idToken);\n\n...\n`}</code></pre>\n    <p>{`Check the updated file `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/dgraph-io/graphql-sample-apps/blob/c94b6eb1cec051238b81482a049100b1cd15bbf7/todo-app-react/src/App.js\"\n      }}>{`here`}</a>{`.`}</p>\n    <p>{`Refer this step in `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/dgraph-io/graphql-sample-apps/commit/c94b6eb1cec051238b81482a049100b1cd15bbf7\"\n      }}>{`GitHub`}</a>{`.`}</p>\n    <p>{`Let's now start the app.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`npm start\n`}</code></pre>\n    <p>{`Now you should have an app running with Auth0!`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}